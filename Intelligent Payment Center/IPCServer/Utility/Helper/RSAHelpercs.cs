using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections.Generic;
using System.Security.Cryptography;
using System.Text;

namespace Utility
{
    public class RSAConfig
    {
        public static string a1(string a4)
        {
            string text = string.Empty;
            double a = 3.1415;
            string[] array = a4.Split(new char[]
            {
            ' '
            });
            int num = 0;
            int upperBound = array.GetUpperBound(0);
            checked
            {
                for (int i = num; i <= upperBound; i += 3)
                {
                    if ((double)Conversions.ToInteger(array[i + 2]) / (double)((int)Math.Round(a)) == unchecked(11.0 * (double)(checked((int)Math.Round(a)))))
                    {
                        text += char.ConvertFromUtf32((int)Math.Round(unchecked(Conversions.ToDouble(array[i]) + 255.0)) * a5(Conversions.ToInteger(array[i + 1])));
                    }
                    else
                    {
                        text += char.ConvertFromUtf32(Conversions.ToInteger(array[i]) * a5(Conversions.ToInteger(array[i + 1])));
                    }
                }
                return text;
            }
        }

        public static int a5(int a4)
        {
            int result;
            if ((double)a4 / 2.0 == (double)(checked((int)Math.Round((double)a4 / 2.0))))
            {
                result = 2;
            }
            else
            {
                result = 1;
            }
            return result;
        }

        public static string a3 = "30 2 36 41 4 53 83 5 98 65 1 63 75 3 69 101 5 116 121 1 119 43 2 49 97 3 91 54 4 66 117 5 132 101 1 101 31 2 37 30 4 42 77 5 92 111 1 109 50 2 56 117 3 111 54 4 66 117 5 132 115 1 113 31 2 37 59 4 71 58 6 76 35 2 41 36 4 48 55 5 70 24 2 30 38 4 50 79 5 94 51 1 49 37 2 43 47 3 41 75 5 90 83 1 81 58 2 64 27 4 39 81 5 96 105 1 103 97 3 91 101 5 116 42 2 48 105 3 103 37 4 49 37 6 55 59 2 65 50 4 62 83 5 98 51 2 57 43 4 55 107 5 122 105 1 103 57 3 51 65 5 80 51 2 57 57 4 69 53 6 71 39 2 45 69 3 63 57 4 69 99 5 114 55 2 61 50 4 62 67 5 82 111 1 109 40 2 46 121 3 115 55 5 70 51 2 57 35 4 47 39 6 57 115 1 113 25 2 31 50 4 62 25 6 43 79 1 77 49 2 55 51 4 63 111 5 126 47 1 45 69 3 63 67 5 82 24 2 30 111 3 105 25 4 37 65 5 80 49 2 55 40 4 52 101 5 116 44 2 50 83 3 77 115 5 130 54 2 60 117 3 111 57 5 72 89 1 87 53 2 59 55 3 49 53 5 68 40 2 46 56 4 68 73 5 88 49 2 55 35 4 47 107 5 122 41 2 47 113 3 107 49 5 64 34 2 40 44 4 56 39 6 57 49 1 47 55 3 49 25 4 37 47 5 62 113 1 111 71 3 65 103 5 118 44 2 50 49 3 43 55 4 67 49 5 64 26 2 32 87 3 81 101 5 116 77 1 75 85 3 79 24 4 36 28 6 46 53 2 59 51 4 63 52 6 70 33 2 39 77 3 71 79 5 94 54 2 60 115 3 109 40 4 52 38 6 56 107 1 105 52 2 58 67 3 61 53 5 68 101 1 101 53 2 59 109 3 103 119 5 134 53 1 51 83 3 77 43 4 55 115 5 130 101 1 101 51 2 57 43 3 37 111 5 126 49 2 55 77 3 71 44 4 56 24 6 42 99 1 97 113 3 107 49 5 64 51 1 49 61 2 67 55 4 67 37 6 55 49 1 47 58 2 64 45 4 57 87 5 102 43 1 41 101 3 95 49 4 61 53 6 71 24 2 30 39 4 51 117 5 132 51 2 57 103 3 97 121 5 136 41 2 47 109 3 103 75 5 90 55 2 61 35 4 47 38 6 56 53 2 59 101 3 95 55 5 70 113 1 111 35 2 41 42 4 54 24 6 42 61 1 59 30 2 36 47 3 41 77 5 92 111 1 109 50 2 56 117 3 111 54 4 66 117 5 132 115 1 113 31 2 37 30 4 42 69 5 84 60 2 66 56 4 68 111 5 126 55 2 61 101 3 95 55 4 67 58 6 76 31 2 37 65 3 59 81 5 96 65 1 63 33 2 39 30 4 42 47 5 62 69 1 67 60 2 66 56 4 68 111 5 126 55 2 61 101 3 95 55 4 67 58 6 76 31 2 37 30 4 42 47 5 62 41 2 47 83 3 77 65 5 80 75 1 73 101 3 95 121 5 136 43 2 49 97 3 91 54 4 66 117 5 132 101 1 101 31 2 37";

        public static string strPublic = a1(a3);

        public static string a2 = "30 2 36 41 4 53 83 5 98 65 1 63 75 3 69 101 5 116 121 1 119 43 2 49 97 3 91 54 4 66 117 5 132 101 1 101 31 2 37 30 4 42 77 5 92 111 1 109 50 2 56 117 3 111 54 4 66 117 5 132 115 1 113 31 2 37 59 4 71 58 6 76 35 2 41 36 4 48 55 5 70 24 2 30 38 4 50 79 5 94 51 1 49 37 2 43 47 3 41 75 5 90 83 1 81 58 2 64 27 4 39 81 5 96 105 1 103 97 3 91 101 5 116 42 2 48 105 3 103 37 4 49 37 6 55 59 2 65 50 4 62 83 5 98 51 2 57 43 4 55 107 5 122 105 1 103 57 3 51 65 5 80 51 2 57 57 4 69 53 6 71 39 2 45 69 3 63 57 4 69 99 5 114 55 2 61 50 4 62 67 5 82 111 1 109 40 2 46 121 3 115 55 5 70 51 2 57 35 4 47 39 6 57 115 1 113 25 2 31 50 4 62 25 6 43 79 1 77 49 2 55 51 4 63 111 5 126 47 1 45 69 3 63 67 5 82 24 2 30 111 3 105 25 4 37 65 5 80 49 2 55 40 4 52 101 5 116 44 2 50 83 3 77 115 5 130 54 2 60 117 3 111 57 5 72 89 1 87 53 2 59 55 3 49 53 5 68 40 2 46 56 4 68 73 5 88 49 2 55 35 4 47 107 5 122 41 2 47 113 3 107 49 5 64 34 2 40 44 4 56 39 6 57 49 1 47 55 3 49 25 4 37 47 5 62 113 1 111 71 3 65 103 5 118 44 2 50 49 3 43 55 4 67 49 5 64 26 2 32 87 3 81 101 5 116 77 1 75 85 3 79 24 4 36 28 6 46 53 2 59 51 4 63 52 6 70 33 2 39 77 3 71 79 5 94 54 2 60 115 3 109 40 4 52 38 6 56 107 1 105 52 2 58 67 3 61 53 5 68 101 1 101 53 2 59 109 3 103 119 5 134 53 1 51 83 3 77 43 4 55 115 5 130 101 1 101 51 2 57 43 3 37 111 5 126 49 2 55 77 3 71 44 4 56 24 6 42 99 1 97 113 3 107 49 5 64 51 1 49 61 2 67 55 4 67 37 6 55 49 1 47 58 2 64 45 4 57 87 5 102 43 1 41 101 3 95 49 4 61 53 6 71 24 2 30 39 4 51 117 5 132 51 2 57 103 3 97 121 5 136 41 2 47 109 3 103 75 5 90 55 2 61 35 4 47 38 6 56 53 2 59 101 3 95 55 5 70 113 1 111 35 2 41 42 4 54 24 6 42 61 1 59 30 2 36 47 3 41 77 5 92 111 1 109 50 2 56 117 3 111 54 4 66 117 5 132 115 1 113 31 2 37 30 4 42 69 5 84 60 2 66 56 4 68 111 5 126 55 2 61 101 3 95 55 4 67 58 6 76 31 2 37 65 3 59 81 5 96 65 1 63 33 2 39 30 4 42 47 5 62 69 1 67 60 2 66 56 4 68 111 5 126 55 2 61 101 3 95 55 4 67 58 6 76 31 2 37 30 4 42 40 6 58 31 2 37 51 3 45 38 4 50 89 5 104 43 1 41 75 3 69 41 4 53 115 5 130 77 1 75 109 3 103 47 5 62 115 1 113 97 3 91 97 5 112 99 1 97 24 2 30 73 3 67 101 5 116 28 2 34 45 4 57 71 5 86 43 2 49 115 3 109 119 5 134 47 1 45 55 2 61 51 3 45 43 4 55 28 6 46 103 1 101 35 2 41 28 4 40 60 6 78 97 1 95 53 3 47 87 5 102 51 1 49 52 2 58 26 4 38 54 6 72 53 1 51 41 2 47 65 3 59 28 4 40 89 5 104 34 2 40 105 3 103 40 4 52 53 6 71 53 1 51 53 2 59 113 3 107 53 4 65 73 5 88 69 1 67 121 3 115 101 5 116 49 2 55 71 3 65 38 4 50 60 6 78 71 1 69 117 3 111 25 4 37 69 5 84 101 1 101 97 3 91 115 5 130 53 2 59 49 4 61 89 5 104 53 1 51 57 2 63 50 4 62 79 5 94 115 1 113 50 2 56 50 4 62 42 6 60 56 2 62 57 4 69 109 5 124 58 2 64 43 3 37 99 5 114 40 2 46 119 3 113 61 5 76 61 1 59 30 2 36 47 3 41 40 4 52 31 6 49 30 2 36 81 3 75 31 4 43 51 5 66 43 2 49 39 4 51 49 5 64 44 2 50 83 3 77 121 5 136 115 1 113 81 3 75 113 5 128 42 2 48 65 3 59 59 4 71 65 5 80 83 1 81 39 2 45 97 3 91 49 5 64 103 1 101 89 3 83 83 5 98 111 1 109 35 2 41 57 3 51 25 4 37 60 6 78 105 1 103 39 2 45 51 3 45 75 5 90 111 1 109 26 2 32 54 4 66 113 5 128 45 2 51 43 3 37 33 4 45 57 5 72 43 2 49 38 4 50 49 6 67 53 2 59 57 4 69 53 5 68 119 1 117 77 3 71 54 4 66 50 6 68 38 2 44 111 3 105 39 4 51 26 6 44 49 1 47 60 2 66 42 4 54 56 6 74 36 2 42 89 3 83 79 5 94 39 2 45 35 4 47 37 6 55 56 2 62 56 4 68 36 6 54 69 1 67 47 3 41 61 4 73 28 6 46 81 1 79 39 2 45 57 3 51 40 4 52 50 6 68 43 2 49 53 4 65 87 5 102 52 2 58 25 4 37 60 6 78 51 2 57 119 3 113 27 4 39 51 6 69 103 1 101 119 3 113 61 5 76 61 1 59 30 2 36 47 3 41 81 5 96 31 2 37 30 4 42 34 6 52 40 2 46 31 4 43 71 5 86 103 1 101 107 3 101 53 5 68 53 2 59 51 4 63 55 6 73 39 2 45 26 4 38 47 5 62 121 1 119 99 3 93 73 5 88 103 1 101 61 2 67 26 4 38 121 5 136 53 2 59 107 3 101 97 5 112 52 2 58 41 4 53 83 5 98 49 1 47 69 3 63 75 5 90 50 2 56 26 4 38 43 6 61 25 2 31 33 4 45 53 6 71 89 1 87 41 2 47 67 3 61 45 4 57 41 6 59 39 2 45 53 4 65 44 6 62 119 1 117 69 3 63 113 5 128 42 2 48 105 3 103 39 4 51 57 5 72 28 2 34 43 3 37 43 5 58 42 2 48 65 3 59 53 5 68 26 2 32 101 3 95 67 5 82 42 2 48 77 3 71 34 4 46 53 6 71 39 2 45 107 3 101 61 4 73 28 6 46 105 1 103 113 3 107 55 4 67 65 5 80 54 2 60 83 3 77 42 4 54 117 5 132 24 2 30 105 3 103 24 4 36 71 5 86 36 2 42 45 4 57 85 5 100 43 2 49 113 3 107 111 5 126 33 2 39 107 3 101 87 5 102 119 1 117 61 3 55 61 5 76 30 2 36 47 3 41 34 4 46 40 6 58 31 2 37 30 4 42 34 6 52 81 1 79 31 2 37 51 4 63 51 5 66 33 2 39 87 3 81 25 4 37 57 5 72 101 1 101 54 2 60 79 3 73 37 4 49 56 6 74 24 2 30 47 3 41 28 4 40 51 5 66 47 1 45 81 3 75 33 4 45 51 6 69 60 2 66 56 4 68 38 6 56 42 2 48 55 3 49 75 5 90 59 2 65 42 4 54 119 5 134 101 1 101 109 3 103 49 4 61 56 6 74 40 2 46 56 4 68 87 5 102 40 2 46 49 4 61 67 5 82 77 1 75 28 2 34 24 4 36 55 5 70 40 2 46 41 4 53 113 5 128 49 1 47 52 2 58 71 3 65 57 5 72 24 2 30 54 4 66 115 5 130 103 1 101 121 3 115 59 4 71 51 6 69 38 2 44 115 3 109 50 4 62 89 5 104 57 2 63 77 3 71 60 4 72 99 5 114 83 1 81 45 2 51 107 3 101 51 4 63 57 5 72 43 2 49 55 3 49 24 4 36 57 5 72 109 1 107 25 2 31 119 3 113 42 4 54 25 6 43 58 2 64 45 4 57 107 5 122 38 2 44 50 4 62 121 5 136 24 2 30 81 3 75 61 5 76 61 1 59 30 2 36 47 3 41 34 4 46 81 5 96 31 2 37 30 4 42 73 5 88 55 2 61 59 4 71 101 5 116 57 2 63 115 3 109 101 5 116 81 1 79 31 2 37 35 4 47 26 6 44 38 2 44 57 3 51 38 4 50 24 6 42 97 1 95 53 3 47 101 5 116 42 2 48 111 3 105 33 4 45 27 6 45 57 1 55 55 3 49 113 5 128 65 1 63 49 2 55 53 4 65 117 5 132 69 1 67 79 3 73 65 5 80 39 2 45 53 3 47 107 5 122 25 2 31 97 3 91 50 4 62 73 5 88 77 1 75 39 2 45 85 3 79 61 4 73 51 6 69 24 2 30 121 3 115 40 4 52 107 5 122 103 1 101 55 3 49 119 5 134 77 1 75 81 3 75 109 5 124 52 2 58 109 3 103 53 5 68 51 2 57 49 3 43 44 4 56 89 5 104 87 1 85 50 2 56 107 3 101 41 4 53 43 6 61 69 1 67 41 2 47 26 4 38 57 6 75 113 1 111 55 2 61 43 3 37 101 5 116 45 2 51 33 4 45 49 5 64 37 2 43 115 3 109 107 5 122 97 1 95 27 2 33 57 3 51 51 4 63 25 6 43 89 1 87 28 2 34 121 3 115 77 5 92 25 2 31 105 3 103 40 4 52 34 6 52 37 2 43 81 3 75 61 5 76 61 1 59 30 2 36 47 3 41 73 5 88 55 2 61 59 4 71 101 5 116 57 2 63 115 3 109 101 5 116 81 1 79 31 2 37 30 4 42 34 6 52 31 2 37 89 3 83 105 5 120 42 2 48 113 3 107 41 4 53 58 6 76 109 1 107 56 2 62 53 3 47 34 4 46 103 5 118 49 2 55 113 3 107 33 4 45 27 6 45 37 2 43 89 3 83 81 5 96 40 2 46 99 3 93 69 5 84 105 1 103 97 3 91 51 4 63 41 6 59 42 2 48 49 4 61 42 6 60 49 1 47 55 2 61 105 3 103 40 4 52 41 6 59 53 1 51 53 3 47 58 4 70 101 5 116 43 1 41 55 3 49 81 5 96 85 1 83 67 3 61 39 4 51 67 5 82 39 2 45 37 4 49 109 5 124 24 2 30 121 3 115 50 4 62 50 6 68 65 1 63 35 2 41 77 3 71 59 4 71 75 5 90 119 1 117 49 3 43 117 5 132 51 1 49 65 3 59 43 5 58 61 2 67 49 4 61 51 5 66 42 2 48 65 3 59 38 4 50 54 6 72 39 2 45 43 3 37 43 5 58 40 2 46 55 4 67 40 6 58 83 1 81 101 3 95 53 5 68 50 2 56 59 4 71 111 5 126 75 1 73 113 3 107 47 5 62 39 2 45 117 3 111 49 4 61 54 6 72 54 2 60 97 3 91 49 4 61 52 6 70 55 2 61 53 3 47 81 5 96 73 1 71 115 3 109 47 5 62 49 2 55 39 4 51 56 6 74 34 2 40 51 4 63 79 5 94 43 2 49 107 3 101 99 5 114 67 1 65 53 3 47 105 5 120 99 1 97 101 3 95 60 4 72 61 6 79 52 2 58 24 4 36 45 6 63 58 2 64 58 4 70 39 6 57 55 2 61 87 3 81 27 4 39 59 6 77 85 1 83 33 2 39 25 4 37 28 6 46 55 2 61 47 3 41 47 5 62 69 1 67 59 2 65 35 4 47 107 5 122 49 1 47 28 2 34 60 4 72 58 6 76 49 2 55 67 3 61 105 5 120 55 1 53 52 2 58 43 4 55 34 6 52 117 1 115 44 2 50 121 3 115 58 4 70 36 6 54 105 1 103 111 3 105 87 5 102 42 2 48 28 4 40 54 6 72 105 1 103 57 3 51 43 4 55 28 6 46 99 1 97 44 2 50 109 3 103 55 4 67 71 5 86 89 1 87 59 2 65 107 3 101 49 5 64 69 1 67 61 3 55 30 4 42 47 5 62 34 2 40 31 4 43 30 6 48 47 1 45 41 2 47 83 3 77 65 5 80 75 1 73 101 3 95 121 5 136 43 2 49 97 3 91 54 4 66 117 5 132 101 1 101 31 2 37";

        public static string strPivate = Encoding.UTF8.GetString(Convert.FromBase64String("PFJTQUtleVZhbHVlPjxNb2R1bHVzPnZ0Rkg3MExPM0ovS1N0NlFpYWVUaUpKdmRTZlZraTlBZnJqTkVyY25kQ29QeTdmRk5zMmQyT2Jmby9FQzBvMkFiUGVYU3NsdTlZajc1UHBJYkZrUnExRFhOMTcyL3FHZ1gxbjE0V2VNVTA4amZoQk1PbHNQTGtoQzVlam13NVNWc2VmK29iTVgwY3ExM3puSjF0WlcrZWJqME51Zmd5Um1LbkZMamU3cUZUMD08L01vZHVsdXM+PEV4cG9uZW50PkFRQUI8L0V4cG9uZW50PjxQPjNMWStLUnNNbS9zYWFjMEllOFpHVnN3L24zVjhnRjh4YTVXM2g0bDVSQThZRGlQajVqcWpJRXllYkdMeEd1MkVlYXNqYlk1cmRPc2RkVHBybXQrY1B3PT08L1A+PFE+M1ZOMVhTeXNRcVRBdkFTTmExZ1lTb0Y5MnhpTjNLbzRscVorQjlWTGJqcjV3TWxkTG9ONDF4VHBIWU9ORkpwcEhFL3o4UU45UGRWaldoMnhmdzZmZ3c9PTwvUT48RFA+R2drNWpmbk40L3ljSWd6NHlqa2FoUlMxRUtkNFYyQmpZUkNaUk5qWHdFcVRpTjk4KytUQTU0ZUNUTURqTmt6OGlxbkFsU1R1MGkwR0haVVZxb0JrV3c9PTwvRFA+PERRPmYzQlcyOWVsT0pwMC84My9RQmZ4cExUN0t2VHdlbWJwUHBXUGJDTTgwN1BScTFoRzkwbHNneXZmTHNkWXJNeGNTWmtmOVY3MDltMndUMnRaa0xkeTBRPT08L0RRPjxJbnZlcnNlUT5GNEw5TDBhNWVUb0I2OTdxQWJqdUVPQU41azJhZElNTlV6ZjB5UGtnN3dNUW1obTVmMVhZV2RrUlZFUjRycW4rZVpCMUpza2E2OWYyWTh5TTJpUERKUT09PC9JbnZlcnNlUT48RD5ZaVRxUnRtcDVEZ2JxQjZKWVFQY0VpYWZSVGJUMW5pUFI1NXRlKzdRVUNOQ05KbTB5ZGRBRk12S3cxdTNBK3piM1RBTGxOKytQblBTZTVkdm9LcS9OdWJsbGFiaG41UUlzL2JOcERmT1ZrY0M1aWNleHpoMFp0dE5uVzZ2VUIyOG4vL0V2RmsxOHh0YkNpN2hWRHVYeXRIaW9XVDhsaTlWOGNYbW5HWXZrMUU9PC9EPjwvUlNBS2V5VmFsdWU+"));

        private static string b2 =
                "43 2 49 51 4 63 56 6 74 32 2 38 44 4 56 77 5 92 60 2 66 35 3 29 77 5 92 71 1 69 38 2 44 21 4 33 97 5 112 33 2 39 37 3 31 49 5 64 43 2 49 79 3 73 89 5 104";

        public static string strSigKey = Encoding.UTF8.GetString(Convert.FromBase64String("VmZwQFhNeCNNR0wqYUIlMVZPWQ=="));
    }
    public static class RSAHelper
    {
        public static byte[] Encrypt(byte[] Data, RSAParameters RSAKey, bool DoOAEPPadding = true)
        {
            try
            {
                byte[] encryptedData;
                using (RSACryptoServiceProvider RSA = new RSACryptoServiceProvider())
                {
                    RSA.ImportParameters(RSAKey);
                    encryptedData = RSA.Encrypt(Data, DoOAEPPadding);
                }
                return encryptedData;
            }
            catch (CryptographicException e)
            {
                Console.WriteLine(e.Message);
                return null;
            }
        }
        static public byte[] Decrypt(byte[] Data, RSAParameters RSAKey, bool DoOAEPPadding = true)
        {
            try
            {
                byte[] decryptedData;
                using (RSACryptoServiceProvider RSA = new RSACryptoServiceProvider())
                {
                    RSA.ImportParameters(RSAKey);
                    decryptedData = RSA.Decrypt(Data, DoOAEPPadding);
                }
                return decryptedData;
            }
            catch (CryptographicException e)
            {
                Console.WriteLine(e.ToString());
                return null;
            }
        }
    }
}
